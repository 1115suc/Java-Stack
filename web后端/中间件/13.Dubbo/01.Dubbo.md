# ğŸš€ Dubbo

## ğŸ“¡ RPC æ ¸å¿ƒæ¦‚å¿µ

- **RPC**ï¼ˆRemote Procedure Callï¼‰â€” **è¿œç¨‹è¿‡ç¨‹è°ƒç”¨**ï¼Œå®ƒæ˜¯ä¸€ç§é€šè¿‡ **ç½‘ç»œ** ä»è¿œç¨‹è®¡ç®—æœºç¨‹åºä¸Šè¯·æ±‚æœåŠ¡ï¼Œè€Œä¸éœ€è¦äº†è§£åº•å±‚ç½‘ç»œæŠ€æœ¯çš„åè®®
- åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨å³æ˜¯ **è¿œç¨‹æ–¹æ³•è°ƒç”¨**
- **æ ¸å¿ƒä¼˜åŠ¿**ï¼šå±è”½ç½‘ç»œé€šä¿¡ç»†èŠ‚ï¼Œè®©è°ƒç”¨è¿œç¨‹æœåŠ¡åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·ç®€å•

![1561472698022.png](img/1561472698022.png)

### ğŸ’« Dubbo æ¦‚å¿µ

- Dubboæ˜¯é˜¿é‡Œå·´å·´å…¬å¸å¼€æºçš„ä¸€ä¸ª**é«˜æ€§èƒ½ã€è½»é‡çº§**çš„ Java RPC æ¡†æ¶
- è‡´åŠ›äºæä¾›**é«˜æ€§èƒ½**å’Œ**é€æ˜åŒ–**çš„ RPC è¿œç¨‹æœåŠ¡è°ƒç”¨æ–¹æ¡ˆï¼Œä»¥åŠ SOA æœåŠ¡æ²»ç†æ–¹æ¡ˆ
- å®˜ç½‘ï¼šhttp://dubbo.apache.org
- **å‘å±•å†å²**ï¼š2011å¹´å¼€æºï¼Œ2014å¹´åœæ­¢ç»´æŠ¤ï¼Œ2018å¹´æçŒ®ç»™ Apache è½¯ä»¶åŸºé‡‘ä¼š

### ğŸ—ï¸ Dubbo æ¶æ„

![img_1.png](img/img_1.png)

| è§’è‰² | è¯´æ˜ |
|------|------|
| **Provider** | ğŸ˜ æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ |
| **Container** | ğŸ“¦ æœåŠ¡è¿è¡Œå®¹å™¨ |
| **Consumer** | ğŸ‘¤ è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ |
| **Registry** | ğŸ›ï¸ æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒ |
| **Monitor** | ğŸ“Š ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒ |

### ğŸš€ Dubbo å¿«é€Ÿå…¥é—¨

- åˆ›å»ºæœåŠ¡æä¾›è€…**Provider**æ¨¡å—
- åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…**Consumer**æ¨¡å—
- åœ¨æœåŠ¡æä¾›è€…æ¨¡å—ç¼–å†™ [UserServiceImpl](file:///E:%5CUsers%5C32147%5CDocuments%5CObsidian%20Vault%5CJava-Stack%5Cweb%E5%90%8E%E7%AB%AF%5C%E4%B8%AD%E9%97%B4%E4%BB%B6%5C13.Dubbo%5C01.Dubbo.md#L51) æä¾›æœåŠ¡
- åœ¨æœåŠ¡æ¶ˆè´¹è€…ä¸­çš„ [UserController](file:///E:%5CUsers%5C32147%5CDocuments%5CObsidian%20Vault%5CJava-Stack%5Cweb%E5%90%8E%E7%AB%AF%5C%E4%B8%AD%E9%97%B4%E4%BB%B6%5C13.Dubbo%5C01.Dubbo.md#L71) è¿œç¨‹è°ƒç”¨[UserServiceImpl](file:///E:%5CUsers%5C32147%5CDocuments%5CObsidian%20Vault%5CJava-Stack%5Cweb%E5%90%8E%E7%AB%AF%5C%E4%B8%AD%E9%97%B4%E4%BB%B6%5C13.Dubbo%5C01.Dubbo.md#L51) æä¾›çš„æœåŠ¡

## ğŸ”„ SpringBoot é¡¹ç›®æ•´åˆ Dubbo

### ğŸ—ï¸ åˆ›å»ºæœåŠ¡æä¾›è€… Provider æ¨¡å—

#### 1. å¼•å…¥ä¾èµ–

```xml
<dependencies>
    <dependency>
        <groupId>org.apache.dubbo</groupId>
        <artifactId>dubbo-dependencies-zookeeper</artifactId>
        <version>2.7.4.1</version>
        <type>pom</type>
        <exclusions>
            <exclusion>
                <groupId>org.slf4j</groupId>
                <artifactId>slf4j-log4j12</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <!-- dubbo 2.7.xå¼•å…¥-->
    <dependency>
        <groupId>org.apache.dubbo</groupId>
        <artifactId>dubbo-spring-boot-starter</artifactId>
        <version>2.7.4.1</version>
    </dependency>
</dependencies>
```


#### 2. åˆ›å»º UserService æ¥å£

```java
public interface UserService {
    public String sayHello();
}
```


#### 3. åˆ›å»º UserServiceImpl å®ç°ç±»

```java
import org.apache.dubbo.config.annotation.Service;

@Service       // å¯¼å…¥dubboçš„serviceæ³¨è§£ï¼Œå°†è¿™ä¸ªç±»æä¾›çš„æ–¹æ³•å¯¹å¤–å‘å¸ƒï¼Œæ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä¸­
public class UserServiceImpl implements UserService {

    @Override
    public String sayHello() {
        return "hello dubbo !";
    }
}
```


> âš ï¸ **æ³¨æ„**ï¼šè¿™é‡Œä½¿ç”¨çš„æ˜¯ `org.apache.dubbo.config.annotation.Service`ï¼Œä¸æ˜¯Springçš„@Service

#### 4. é…ç½® yaml æ–‡ä»¶

```yaml
dubbo:
  registry:
    address: zookeeper://127.0.0.1:2181   #è‡ªå·±çš„zookeeperæœåŠ¡å™¨çš„IP:é»˜è®¤ç«¯å£å·
  application:
    name: dubbo-zookeeper-producer1 #æ³¨å†Œè¿›å»çš„åå­—
  protocol:
    name: dubbo     #è®¾ç½®ç±»å‹
    port: -1      #å› ä¸ºdubboçš„æœåŠ¡å™¨ç«¯å£å·æ˜¯ä¸èƒ½å”¯ä¸€çš„ï¼Œæ‰€ä»¥ï¼Œè®¾ç½®ä¸º-1ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨æ”¹å˜ç«¯å£å·
  config-center:
    timeout: 120000  #è¶…æ—¶æ—¶é—´  ï¼ˆæ¯«ç§’ï¼‰
```


### ğŸ“± åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€… Consumer æ¨¡å—

#### 1. å¼•å…¥ä¾èµ–

```xml
<dependencies>
    <!--dubbo-zookeeper-->
    <dependency>
        <groupId>org.apache.dubbo</groupId>
        <artifactId>dubbo-dependencies-zookeeper</artifactId>
        <version>2.7.4.1</version>
        <type>pom</type>
        <exclusions>
            <exclusion>
                <groupId>org.slf4j</groupId>
                <artifactId>slf4j-log4j12</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <!-- dubbo 2.7.xå¼•å…¥-->
    <dependency>
        <groupId>org.apache.dubbo</groupId>
        <artifactId>dubbo-spring-boot-starter</artifactId>
        <version>2.7.4.1</version>
    </dependency>
</dependencies>
```


#### 2. åˆ›å»º UserController

```java
@RestController
@RequestMapping("/user")
public class UserController {
    @Reference          //dubbo çš„ Reference
    private UserService userService;

    @RequestMapping("/sayHello")
    public String sayHello() {
        return userService.sayHello();
    }
}
```


> âš ï¸ **æ³¨æ„**ï¼šè¿™é‡Œä½¿ç”¨çš„æ˜¯ `org.apache.dubbo.config.annotation.Reference`ï¼Œä¸æ˜¯Springçš„@Autowire

#### 3. é…ç½® yaml æ–‡ä»¶

```yaml
dubbo:
  registry:
    address: zookeeper://127.0.0.1:2181   #è‡ªå·±çš„zookeeperæœåŠ¡å™¨çš„IP:é»˜è®¤ç«¯å£å·
  application:
    name: dubbo-zookeeper-consumer1 #æ³¨å†Œè¿›å»çš„åå­—ï¼ˆæ³¨æ„ä¸providerä¸åŒï¼‰
  protocol:
    name: dubbo     #è®¾ç½®ç±»å‹
    port: -1      #å› ä¸ºdubboçš„æœåŠ¡å™¨ç«¯å£å·æ˜¯ä¸èƒ½å”¯ä¸€çš„ï¼Œæ‰€ä»¥ï¼Œè®¾ç½®ä¸º-1ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨æ”¹å˜ç«¯å£å·
  config-center:
    timeout: 120000  #è¶…æ—¶æ—¶é—´  ï¼ˆæ¯«ç§’ï¼‰
```


## ğŸ’¡ å…³é”®çŸ¥è¯†ç‚¹è¡¥å……

### ğŸ¯ æ ¸å¿ƒæ³¨è§£è¯´æ˜

- **@Service**ï¼šDubboæœåŠ¡æä¾›æ³¨è§£ï¼Œå°†æœåŠ¡å‘å¸ƒåˆ°æ³¨å†Œä¸­å¿ƒ
- **@Reference**ï¼šDubboæœåŠ¡å¼•ç”¨æ³¨è§£ï¼Œä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡