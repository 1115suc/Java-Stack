# ShardingSphere-JDBC ä½¿ç”¨ ğŸ“š

## æ¦‚è¿° ğŸ“–
ShardingSphere-JDBC æ˜¯ Apache ShardingSphere çš„è½»é‡çº§ Java æ¡†æ¶ï¼Œæä¾›æ•°æ®åº“åˆ†åº“åˆ†è¡¨è§£å†³æ–¹æ¡ˆï¼Œä»¥ jar åŒ…å½¢å¼æä¾›æœåŠ¡ã€‚

## ä»£ç å®ç° ğŸ› ï¸

### åŸºäº inline æ¨¡å¼çš„æ°´å¹³åˆ†åº“åˆ†è¡¨ ğŸ”§

#### 1. æ•°æ®åº“è¡¨ ğŸ—ƒï¸

```sql
CREATE DATABASE `order_db_1` CHARACTER SET 'utf8' COLLATE 'utf8_general_ci';

CREATE TABLE `t_order_1` (
    `order_id` BIGINT (20) NOT NULL COMMENT 'è®¢å•id',
    `price` DECIMAL (10, 2) NOT NULL COMMENT 'è®¢å•ä»·æ ¼',
    `user_id` BIGINT (20) NOT NULL COMMENT 'ä¸‹å•ç”¨æˆ·id',
    `status` VARCHAR (50) CHARACTER
    SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT 'è®¢å•çŠ¶æ€',
    PRIMARY KEY (`order_id`) USING BTREE
) ENGINE = INNODB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;

CREATE TABLE `t_order_2` (
    `order_id` BIGINT (20) NOT NULL COMMENT 'è®¢å•id',
    `price` DECIMAL (10, 2) NOT NULL COMMENT 'è®¢å•ä»·æ ¼',
    `user_id` BIGINT (20) NOT NULL COMMENT 'ä¸‹å•ç”¨æˆ·id',
    `status` VARCHAR (50) CHARACTER
    SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT 'è®¢å•çŠ¶æ€',
    PRIMARY KEY (`order_id`) USING BTREE
) ENGINE = INNODB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;

CREATE DATABASE `order_db_2` CHARACTER SET 'utf8' COLLATE 'utf8_general_ci';

CREATE TABLE `t_order_1` (
    `order_id` BIGINT (20) NOT NULL COMMENT 'è®¢å•id',
    `price` DECIMAL (10, 2) NOT NULL COMMENT 'è®¢å•ä»·æ ¼',
    `user_id` BIGINT (20) NOT NULL COMMENT 'ä¸‹å•ç”¨æˆ·id',
    `status` VARCHAR (50) CHARACTER
    SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT 'è®¢å•çŠ¶æ€',
    PRIMARY KEY (`order_id`) USING BTREE
) ENGINE = INNODB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;

DROP TABLE IF EXISTS `t_order_2`;
CREATE TABLE `t_order_2` (
    `order_id` BIGINT (20) NOT NULL COMMENT 'è®¢å•id',
    `price` DECIMAL (10, 2) NOT NULL COMMENT 'è®¢å•ä»·æ ¼',
    `user_id` BIGINT (20) NOT NULL COMMENT 'ä¸‹å•ç”¨æˆ·id',
    `status` VARCHAR (50) CHARACTER
    SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT 'è®¢å•çŠ¶æ€',
    PRIMARY KEY (`order_id`) USING BTREE
) ENGINE = INNODB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;
```


#### 2. å¼•å…¥ä¾èµ– âš™ï¸

```xml
    <!-- MyBatis-Plus -->
    <dependency>
        <groupId>com.baomidou</groupId>
        <artifactId>mybatis-plus-boot-starter</artifactId>
        <version>3.5.7</version>
    </dependency>
    <!-- Mybatisçš„åˆ†é¡µæ’ä»¶ -->
    <dependency>
        <groupId>com.github.pagehelper</groupId>
        <artifactId>pagehelper-spring-boot-starter</artifactId>
        <version>1.3.0</version>
    </dependency>
    <!-- MyBatis-Plus -->
    <dependency>
        <groupId>com.baomidou</groupId>
        <artifactId>mybatis-plus-spring-boot3-starter</artifactId>
        <version>${mybatis-plus.version}</version>
    </dependency>
    <!-- äº v3.5.9 èµ·ï¼ŒPaginationInnerInterceptor å·²åˆ†ç¦»å‡ºæ¥ã€‚å¦‚éœ€ä½¿ç”¨ï¼Œåˆ™éœ€å•ç‹¬å¼•å…¥ mybatis-plus-jsqlparser ä¾èµ–ï¼Œjdk 11+ å¼•å…¥å¯é€‰æ¨¡å— -->
    <dependency>
        <groupId>com.baomidou</groupId>
        <artifactId>mybatis-plus-jsqlparser</artifactId>
        <version>${mybatis-plus.version}</version>
    </dependency>
    
    <dependency>
        <groupId>org.apache.shardingsphere</groupId>
        <artifactId>sharding-jdbc-spring-boot-starter</artifactId>
        <version>4.0.0-RC1</version>
    </dependency>
    
    <dependency>
        <groupId>com.alibaba</groupId>
        <artifactId>druid</artifactId>
        <version>1.2.8</version>
    </dependency>
```


> ğŸ’¡ **æ³¨æ„**ï¼šShardingSphere-JDBC 4.0.0-RC1 ç‰ˆæœ¬æ˜¯è¾ƒæ—©æœŸç‰ˆæœ¬ï¼Œå»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ç¨³å®šç‰ˆæœ¬ã€‚

#### 3. é…ç½®æ–‡ä»¶ ğŸ“

```properties
# åˆ†è¡¨é…ç½®
# æ•°æ®æºåç§°ï¼Œå¤šæ•°æ®æºä»¥é€—å·åˆ†éš”
spring.shardingsphere.datasource.names=ds1,ds2
# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds1.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds1.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds1.url=jdbc:mysql://192.168.200.128:3306/order_db_1?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&serverTimezone=Asia/Shanghai
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds1.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds1.password=24364726

# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds2.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds2.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds2.url=jdbc:mysql://192.168.200.128:3306/order_db_2?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&serverTimezone=Asia/Shanghai
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds2.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds2.password=24364726

# ç”±æ•°æ®æºå + è¡¨åç»„æˆï¼Œä»¥å°æ•°ç‚¹åˆ†éš”ã€‚å¤šä¸ªè¡¨ä»¥é€—å·åˆ†éš”ï¼Œæ”¯æŒ inline è¡¨è¾¾å¼ã€‚
spring.shardingsphere.sharding.tables.t_order.actual-data-nodes=ds$->{1..2}.t_order_$->{1..2}

# å®šä¹‰åº“åˆ†ç‰‡
# åˆ†ç‰‡åˆ—åç§°
spring.shardingsphere.sharding.tables.t_order.database-strategy.inline.sharding-column=user_id
# åˆ†ç‰‡ç®—æ³•è¡Œè¡¨è¾¾å¼ï¼Œéœ€ç¬¦åˆ groovy è¯­æ³•
spring.shardingsphere.sharding.tables.t_order.database-strategy.inline.algorithm-expression=ds$->{user_id % 2 +1}

# è¡Œè¡¨è¾¾å¼åˆ†ç‰‡ç­–ç•¥
# åˆ†ç‰‡åˆ—åç§°
spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.sharding-column=order_id
# åˆ†ç‰‡ç®—æ³•è¡Œè¡¨è¾¾å¼ï¼Œéœ€ç¬¦åˆ groovy è¯­æ³•
spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.algorithm-expression=t_order_$->{order_id % 2 +1}
```


---

### åŸºäº inline æ¨¡å¼å®ç°å‚ç›´åˆ†åº“ ğŸ“

#### 1. åˆ›å»ºè¡¨ ğŸ—ƒï¸

```sql
CREATE DATABASE `user_db` CHARACTER SET 'utf8' COLLATE 'utf8_general_ci';

CREATE TABLE `t_user` (
    `user_id` BIGINT (20) NOT NULL COMMENT 'ç”¨æˆ·id',
    `fullname` VARCHAR (255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT 'ç”¨æˆ·å§“å',
    `user_type` CHAR (1) DEFAULT NULL COMMENT 'ç”¨æˆ·ç±»å‹',
    PRIMARY KEY (`user_id`) USING BTREE
) ENGINE = INNODB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;
```


#### 2. é…ç½® ğŸ› ï¸

- å¯ä»¥åœ¨æ°´å¹³åˆ†åº“åˆ†è¡¨çš„é…ç½®æ–‡ä»¶åŸºç¡€ä¸Šæ·»åŠ å¦‚ä¸‹é…ç½®

```properties
# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds3.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds3.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds3.url=jdbc:mysql://192.168.200.128:3306/user_db?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&serverTimezone=Asia/Shanghai
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds3.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds3.password=24364726

# é…ç½®ç”¨æˆ·è¡¨ä¿¡æ¯
# ç”±æ•°æ®æºå + è¡¨åç»„æˆï¼Œä»¥å°æ•°ç‚¹åˆ†éš”ã€‚å¤šä¸ªè¡¨ä»¥é€—å·åˆ†éš”ï¼Œæ”¯æŒ inline è¡¨è¾¾å¼ã€‚
spring.shardingsphere.sharding.tables.t_user.actual-data-nodes=ds3.t_user
# åˆ†ç‰‡åˆ—åç§° åœ¨åº“å’Œè¡¨ç›´æ¥å®šä½æ—¶ï¼Œåˆ†ç‰‡é”®å¯ä»¥ä¸æŒ‡å®š
spring.shardingsphere.sharding.tables.t_user.table-strategy.inline.sharding-column=user_id
# åˆ†ç‰‡ç®—æ³•è¡Œè¡¨è¾¾å¼ï¼Œéœ€ç¬¦åˆ groovy è¯­æ³•
spring.shardingsphere.sharding.tables.t_user.table-strategy.inline.algorithm-expression=t_user
```


#### inline æ¨¡å¼æ€»ç»“ ğŸ“

- **ä¼˜ç‚¹**ï¼š
    - é…ç½®ç®€å•ï¼Œå¼€å‘æˆæœ¬ä½ï¼›
    - ä¾¿äºç†è§£å’Œç»´æŠ¤ï¼›
- **ç¼ºç‚¹**ï¼š
    - å¤æ‚çš„åˆ†ç‰‡ç­–ç•¥æ”¯æŒä¸å‹å¥½ï¼›
    - å¯¹èŒƒå›´æŸ¥è¯¢æ”¯æŒä¸å¤ªå‹å¥½ï¼ŒåŠ¨è¾„å…¨èŠ‚ç‚¹æŸ¥è¯¢ï¼ŒæŸ¥è¯¢æ•ˆç‡ä½ä¸‹ï¼›

---

### é»˜è®¤æ•°æ®æºæ¨¡å¼ ğŸ 

- å¦‚æœæ²¡æœ‰é…ç½®åˆ†ç‰‡ç­–ç•¥ï¼Œåˆ™å¯æŒ‡å®šé»˜è®¤è®¿é—®çš„æ•°æ®æºï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€æŒ‡å®šæ•°æ®æºï¼Œæ— éœ€æŒ‡å®šæ•°æ®èŠ‚ç‚¹ã€åº“å’Œè¡¨çš„åˆ†ç‰‡ç­–ç•¥ä¹Ÿæ— éœ€æ‰§è¡Œï¼›
- å¦‚æœåœ¨è¿›è¡Œç›¸å…³æ“ä½œæ—¶ï¼Œå‘ç°**é€»è¾‘è¡¨æ²¡æœ‰å¯¹åº”çš„æ•°æ®èŠ‚ç‚¹ã€åº“è¡¨çš„åˆ†ç‰‡é…ç½®**ï¼Œåˆ™èµ°é»˜è®¤æŒ‡å®šçš„æ•°æ®æºï¼›

#### 1. åˆ›å»ºè¡¨ ğŸ—ƒï¸

```sql
create database default_db character set utf8;

create table tb_log (
    id bigint primary key ,
    info varchar(30)
);
```


#### 2. é…ç½®æ–‡ä»¶ ğŸ“

```properties
# é…ç½®shardingjdbcæ•°æ®æº
# æ•°æ®æºåç§°ï¼Œå¤šæ•°æ®æºä»¥é€—å·åˆ†éš”
spring.shardingsphere.datasource.names=ds1,ds2,ds3,ds4
# é…ç½®æ•°æ®æºå‚æ•°
# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds4.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds4.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds4.url=jdbc:mysql://192.168.200.128:3306/default_db?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&serverTimezone=Asia/Shanghai
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds4.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds4.password=24364726

# é…ç½®é»˜è®¤æ•°æ®æºï¼ˆç‰¹ç‚¹ï¼šå¯¹äºä¸åšåˆ†ç‰‡å¤„ç†çš„æ“ä½œï¼Œéƒ½ä¼šç›´æ¥è®¿é—®é»˜è®¤æ•°æ®æº
# æœªé…ç½®åˆ†ç‰‡è§„åˆ™çš„è¡¨å°†é€šè¿‡é»˜è®¤æ•°æ®æºå®šä½
spring.shardingsphere.sharding.default-data-source-name=ds4
```


---

### å¹¿æ’­è¡¨ ğŸ“¡

#### å¹¿æ’­è¡¨ä»‹ç» ğŸ“–

- å¹¿æ’­è¡¨å±äºæ•°æ®åº“ä¸­æ•°æ®é‡è¾ƒå°å’Œå˜åŠ¨è¾ƒå°‘ï¼Œä¸”å­˜åœ¨é«˜é¢‘è”åˆæŸ¥è¯¢çš„è¡¨ï¼Œæ¯”å¦‚ï¼šæ•°æ®å­—å…¸è¡¨ç­‰å±äºæ­¤å¹¿æ’­è¡¨ã€‚
- å¯ä»¥å°†è¿™ç±»è¡¨åœ¨æ¯ä¸ªæ•°æ®åº“éƒ½ä¿å­˜ä¸€ä»½ï¼Œæ‰€æœ‰æ›´æ–°æ“ä½œéƒ½åŒæ—¶å‘é€åˆ°æ‰€æœ‰åˆ†åº“æ‰§è¡Œã€‚

#### 1. åˆ›å»ºè¡¨ ğŸ—ƒï¸

```sql
#åœ¨æ•°æ®åº“ user_dbã€order_db_1ã€order_db_2ä¸­å‡è¦å»ºè¡¨
CREATE TABLE `t_dict` (
    `dict_id` BIGINT (20) NOT NULL COMMENT 'å­—å…¸id',
    `type` VARCHAR (50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT 'å­—å…¸ç±»å‹',
    `code` VARCHAR (50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT 'å­—å…¸ç¼–ç ',
    `value` VARCHAR (50) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT 'å­—å…¸å€¼',
    PRIMARY KEY (`dict_id`) USING BTREE
) ENGINE = INNODB CHARACTER SET = utf8 COLLATE = utf8_general_ci ROW_FORMAT = Dynamic;
```


#### 2. é…ç½®æ–‡ä»¶ ğŸ“

```properties
spring.shardingsphere.sharding.broadcastâ€tables=t_dict
```


#### 3. æµ‹è¯• ğŸ§ª

```java
    @Autowired
    private TDictMapper tDictMapper;
    
	@Test
    public void commonTable(){
        TDict build = TDict.builder().dictId(1l).code("666").type("1").value("888")
                .build();
        tDictMapper.insert(build);
    }
```


---

### Standard æ¨¡å¼å®ç°åˆ†åº“åˆ†è¡¨ ğŸ¯

#### æ ‡å‡†æ¨¡å¼åˆ†ç‰‡ API ä»‹ç» ğŸ“š

```properties
# ç”¨äºå•åˆ†ç‰‡é”®çš„æ ‡å‡†åˆ†ç‰‡åœºæ™¯
sharding.jdbc.config.sharding.tables.<logic-table-name>.database-strategy.standard.sharding-column= # åˆ†ç‰‡åˆ—åç§°
sharding.jdbc.config.sharding.tables.<logic-table-name>.database-strategy.standard.precise-algorithm-class-name= # ç²¾ç¡®åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº = å’Œ INã€‚è¯¥ç±»éœ€å®ç° PreciseShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
sharding.jdbc.config.sharding.tables.<logic-table-name>.database-strategy.standard.range-algorithm-class-name= # èŒƒå›´åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº BETWEENï¼Œå¯é€‰ã€‚è¯¥ç±»éœ€å®ç° RangeShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
```


- åŸºäºæ ‡å‡†æ¨¡å¼å®ç°åˆ†åº“åˆ†è¡¨ï¼Œéœ€è¦åˆ†åˆ«ä¸ºåº“å’Œè¡¨å®šä¹‰ç²¾å‡†æŸ¥è¯¢å’ŒèŒƒå›´æŸ¥è¯¢å®ç°

![1672846418736.png](img/1672846418736.png)

> `PreciseShardingAlgorithm` ï¼šç²¾å‡†æŸ¥è¯¢åº“æˆ–è€…è¡¨ï¼ˆsqlä½¿ç”¨ä½¿ç”¨äº†= ã€inï¼‰      
> `RangeShardingAlgorithm` ï¼šèŒƒå›´æŸ¥è¯¢åº“æˆ–è€…è¡¨ ï¼ˆbetween and ã€ > ã€ <ï¼‰            
> æ‰€ä»¥ï¼Œä½¿ç”¨ sharding-jdbc æ—¶å°½é‡è®©åˆ†ç‰‡é”®å»æŸ¥è¯¢ï¼Œä¸”éµå¾ªä½¿ç”¨è§„èŒƒï¼›

#### å®šä¹‰æ ‡å‡†åˆ†åº“ç­–ç•¥ ğŸ—ï¸

##### ç²¾å‡†æŸ¥è¯¢åº“å®ç° ğŸ”

```java
public class MyPreciseShardingAlgorithm4Db implements PreciseShardingAlgorithm<Long> {
    @Override
    public String doSharding(Collection<String> dbNames, PreciseShardingValue<Long> shardingValue) {
        //è·å–æ•°æ®åº“çš„åˆ†ç‰‡é”®åç§°ï¼šuser_id
        String dbColumnName = shardingValue.getColumnName();
        //è·å–æ­¤æ—¶æŸ¥è¯¢æ—¶çš„ç‰‡é”®å€¼
        Long value = shardingValue.getValue();
        //è·å–é€»è¾‘è¡¨åç§° t_user
        String logicTableName = shardingValue.getLogicTableName();
        //ds1,ds2 æ ¹æ®åˆ†ç‰‡é”®çš„å€¼è·å–dbName :user_id % 2 +1
        //è·å–æ•°æ®æºçš„ä¸‹æ ‡
        String idx=String.valueOf(value % 2 +1);//1 æˆ–è€… 2
        String dsName = dbNames.stream().filter(dbName -> dbName.endsWith(idx)).findFirst().get();
        return dsName;
    }
}
```


##### èŒƒå›´æŸ¥è¯¢æ•°æ®åº“å®ç° ğŸ“

```java
public class MyRangeShardingAlgorithm4Db implements RangeShardingAlgorithm<Long> {
    @Override
    public Collection<String> doSharding(Collection<String> dsNames, RangeShardingValue<Long> shardingValue) {
        //è·å–åˆ†ç‰‡é”®åç§°
        String columnName = shardingValue.getColumnName();
        //è·å–é€»è¾‘è¡¨
        String logicTableName = shardingValue.getLogicTableName();
        //å¯¹èŒƒå›´æ•°æ®çš„å°è£…
        Range<Long> valueRange = shardingValue.getValueRange();
        //åˆ¤æ–­æ˜¯å¦æœ‰èŒƒå›´æŸ¥è¯¢çš„èµ·å§‹å€¼
        if (valueRange.hasLowerBound()) {
            //è·å–èµ·å§‹å€¼
            Long start = valueRange.lowerEndpoint();//10
        }
        //åˆ¤æ–­æ˜¯å¦æœ‰ä¸Šé™å€¼
        if (valueRange.hasUpperBound()) {
            Long end = valueRange.upperEndpoint();
        }
        //ä¸€èˆ¬ä¼šæ ¹æ®startå’Œendå€¼æ‰¾ç¬¦åˆæ¡ä»¶çš„æ•°æ®æºé›†åˆ
        return Arrays.asList("ds1","ds2");
    }
}
```


##### é…ç½®æ–‡ä»¶ ğŸ“

```properties
# é…ç½®shardingjdbc
# æ•°æ®æºåç§°ï¼Œå¤šæ•°æ®æºä»¥é€—å·åˆ†éš”(datasourceåç§°ä¸è¦ä½¿ç”¨ç‰¹æ®Šç¬¦å·)
spring.shardingsphere.datasource.names=ds1,ds2
# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds1.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds1.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds1.url=jdbc:mysql://192.168.200.128:3306/order_db_1?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&serverTimezone=Asia/Shanghai
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds1.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds1.password=24364726
#spring.shardingsphere.datasource.ds1.xxx= # æ•°æ®åº“è¿æ¥æ± çš„å…¶å®ƒå±æ€§
# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds2.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds2.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds2.url=jdbc:mysql://192.168.200.128:3306/order_db_2?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&serverTimezone=Asia/Shanghai
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds2.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds2.password=24364726

# é…ç½®æ•°æ®èŠ‚ç‚¹ï¼šdatanode,æ•°æ®æº.è¡¨ t_orderæ˜¯é€»è¾‘è¡¨ï¼Œå±äºt_order_1å’Œt_order_2
spring.shardingsphere.sharding.tables.t_order.actual-data-nodes=ds$->{1..2}.t_order_$->{1..2}

# åˆ†åº“ç­–ç•¥ï¼Œç¼ºçœè¡¨ç¤ºä½¿ç”¨é»˜è®¤åˆ†åº“ç­–ç•¥ï¼Œä»¥ä¸‹çš„åˆ†ç‰‡ç­–ç•¥åªèƒ½é€‰å…¶ä¸€
# ä½¿ç”¨æ ‡å‡†åˆ†ç‰‡ç­–ç•¥
# ç”¨äºå•åˆ†ç‰‡é”®çš„æ ‡å‡†åˆ†ç‰‡åœºæ™¯
# åˆ†ç‰‡åˆ—åç§°,æŒ‡å®šæ ‡å‡†åˆ†ç‰‡åº“çš„ç‰‡é”®
spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.sharding-column=user_id
# ç²¾ç¡®åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº = å’Œ INã€‚è¯¥ç±»éœ€å®ç° PreciseShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.precise-algorithm-class-name=com.itheima.algorithm.MyPreciseShardingAlgorithm4Db
# èŒƒå›´åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº BETWEENï¼Œå¯é€‰ã€‚è¯¥ç±»éœ€å®ç° RangeShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.range-algorithm-class-name=com.itheima.algorithm.MyRangeShardingAlgorithm4Db

# åˆ†è¡¨ç­–ç•¥
## åˆ†ç‰‡åˆ—åç§°
spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.sharding-column=order_id
# åˆ†ç‰‡ç®—æ³•è¡Œè¡¨è¾¾å¼ï¼Œéœ€ç¬¦åˆ groovy è¯­æ³•
spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.algorithm-expression=t_order_$->{order_id % 2 +1}
# æ˜¯å¦å¼€å¯ SQL æ˜¾ç¤ºï¼Œé»˜è®¤å€¼: false
spring.shardingsphere.props.sql.show=true
```


#### å®šä¹‰æ ‡å‡†åˆ†è¡¨ç­–ç•¥ ğŸ¯

##### ç²¾å‡†æŸ¥è¯¢è¡¨å®ç° ğŸ”

```java
public class MyPreciseShardingAlgorithm4Tb implements PreciseShardingAlgorithm<Long> {
    @Override
    public String doSharding(Collection<String> tbNames, PreciseShardingValue<Long> shardingValue) {
        //è·å–æ•°æ®åº“çš„åˆ†ç‰‡é”®åç§°ï¼šorder_id
        String dbColumnName = shardingValue.getColumnName();
        //è·å–æ­¤æ—¶æŸ¥è¯¢æ—¶çš„ç‰‡é”®å€¼
        Long value = shardingValue.getValue();
        //è·å–é€»è¾‘è¡¨åç§° t_user
        String logicTableName = shardingValue.getLogicTableName();
        //ds1,ds2 æ ¹æ®åˆ†ç‰‡é”®çš„å€¼è·å–dbName :user_id % 2 +1
        //è·å–æ•°æ®æºçš„ä¸‹æ ‡
        String idx=String.valueOf(value % 2 +1);//1 æˆ–è€… 2
        String tName = tbNames.stream().filter(dbName -> dbName.endsWith(idx)).findFirst().get();
        return tName;
    }
}
```


##### èŒƒå›´æŸ¥è¯¢è¡¨å®ç° ğŸ“

```java
public class MyRangeShardingAlgorithm4Tb implements RangeShardingAlgorithm<Long> {
    @Override
    public Collection<String> doSharding(Collection<String> tbNames, RangeShardingValue<Long> shardingValue) {
        //è·å–åˆ†ç‰‡é”®åç§°
        String columnName = shardingValue.getColumnName();
        //è·å–é€»è¾‘è¡¨
        String logicTableName = shardingValue.getLogicTableName();
        //å¯¹èŒƒå›´æ•°æ®çš„å°è£…
        Range<Long> valueRange = shardingValue.getValueRange();
        //åˆ¤æ–­æ˜¯å¦æœ‰èŒƒå›´æŸ¥è¯¢çš„èµ·å§‹å€¼
        if (valueRange.hasLowerBound()) {
            //è·å–èµ·å§‹å€¼
            Long start = valueRange.lowerEndpoint();//10
        }
        //åˆ¤æ–­æ˜¯å¦æœ‰ä¸Šé™å€¼
        if (valueRange.hasUpperBound()) {
            Long end = valueRange.upperEndpoint();
        }
        //ä¸€èˆ¬ä¼šæ ¹æ®startå’Œendå€¼æ‰¾ç¬¦åˆæ¡ä»¶çš„æ•°æ®æºé›†åˆ
        return Arrays.asList("t_order_1","t_order_2");
    }
}
```


##### é…ç½®æ–‡ä»¶ ğŸ“

```properties
# é…ç½®shardingjdbc
# æ•°æ®æºåç§°ï¼Œå¤šæ•°æ®æºä»¥é€—å·åˆ†éš”(datasourceåç§°ä¸è¦ä½¿ç”¨ç‰¹æ®Šç¬¦å·)
spring.shardingsphere.datasource.names=ds1,ds2
# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds1.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds1.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds1.url=jdbc:mysql://192.168.200.128:3306/order_db_1?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&serverTimezone=Asia/Shanghai
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds1.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds1.password=root
#spring.shardingsphere.datasource.ds1.xxx= # æ•°æ®åº“è¿æ¥æ± çš„å…¶å®ƒå±æ€§
# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds2.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds2.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds2.url=jdbc:mysql://192.168.200.128:3306/order_db_2?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&serverTimezone=Asia/Shanghai
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds2.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds2.password=root

# é…ç½®æ•°æ®èŠ‚ç‚¹ï¼šdatanode,æ•°æ®æº.è¡¨ t_orderæ˜¯é€»è¾‘è¡¨ï¼Œå±äºt_order_1å’Œt_order_2
spring.shardingsphere.sharding.tables.t_order.actual-data-nodes=ds$->{1..2}.t_order_$->{1..2}

# åˆ†åº“ç­–ç•¥ï¼Œç¼ºçœè¡¨ç¤ºä½¿ç”¨é»˜è®¤åˆ†åº“ç­–ç•¥ï¼Œä»¥ä¸‹çš„åˆ†ç‰‡ç­–ç•¥åªèƒ½é€‰å…¶ä¸€
spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.sharding-column=user_id
# ç²¾ç¡®åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº = å’Œ INã€‚è¯¥ç±»éœ€å®ç° PreciseShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.precise-algorithm-class-name=com.itheima.algorithm.MyPreciseShardingAlgorithm4Db
# èŒƒå›´åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº BETWEENï¼Œå¯é€‰ã€‚è¯¥ç±»éœ€å®ç° RangeShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.range-algorithm-class-name=com.itheima.algorithm.MyRangeShardingAlgorithm4Db

# åˆ†è¡¨ç­–ç•¥
spring.shardingsphere.sharding.tables.t_order.table-strategy.standard.sharding-column=order_id
# ç²¾ç¡®åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº = å’Œ INã€‚è¯¥ç±»éœ€å®ç° PreciseShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
spring.shardingsphere.sharding.tables.t_order.table-strategy.standard.precise-algorithm-class-name=com.itheima.algorithm.MyPreciseShardingAlgorithm4Tb
# èŒƒå›´åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº BETWEENï¼Œå¯é€‰ã€‚è¯¥ç±»éœ€å®ç° RangeShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
spring.shardingsphere.sharding.tables.t_order.table-strategy.standard.range-algorithm-class-name=com.itheima.algorithm.MyRangeShardingAlgorithm4Tb
# æ˜¯å¦å¼€å¯ SQL æ˜¾ç¤ºï¼Œé»˜è®¤å€¼: false
spring.shardingsphere.props.sql.show=true
```


#### å®šä¹‰åº“çš„åˆ†ç‰‡ç®—æ³•ç±» ğŸ—ï¸

```java
public class CommonAlgorithm4Db implements PreciseShardingAlgorithm<Long>, RangeShardingAlgorithm<Long> {
    @Override
    public String doSharding(Collection<String> dsNames, PreciseShardingValue<Long> shardingValue) {
        //è·å–æ•°æ®åº“åˆ†ç‰‡çš„å­—æ®µåç§° user_id = in
        String columnName = shardingValue.getColumnName();
        //è·å–é€»è¾‘è¡¨åç§°
        String logicTableName = shardingValue.getLogicTableName();
        //è·å–ç‰‡é”®å¯¹åº”çš„å€¼ select * from t_order where user_id=10,è¿™é‡Œçš„valueå°±ç­‰äº10
        Long value = shardingValue.getValue();
        //ä¸€èˆ¬æ˜¯æ ¹æ®ç‰‡é”®å€¼è·å–å¯¹åº”çš„æ•°æ®æºï¼Œå¹¶è¿”å›
        String sufix=String.valueOf(value % 2 +1);
        String dsName = dsNames.stream().filter(ds -> ds.endsWith(sufix)).findFirst().get();
        return dsName;
    }
    
    @Override
    public Collection<String> doSharding(Collection<String> dsNames, RangeShardingValue<Long> shardingValue) {
        //è·å–åˆ†ç‰‡å­—æ®µ
        String columnName = shardingValue.getColumnName();
        //è·å–é€»è¾‘è¡¨
        String logicTableName = shardingValue.getLogicTableName();
        //è·å–èŒƒå›´æ•°æ®
        Range<Long> valueRange = shardingValue.getValueRange();
        //select * from t_order where user_id between 1 and 20;
        //åˆ¤æ–­æ˜¯å¦æœ‰ä¸Šé™å€¼
        if (valueRange.hasUpperBound()) {
            //è·å–ä¸Šé™å€¼ 20
            Long uppper = valueRange.upperEndpoint();
            System.out.println(uppper);
        }
        if (valueRange.hasLowerBound()){
            Long lower = valueRange.lowerEndpoint();
            System.out.println(lower);
        }
        //ç†è®ºä¸Šè¦æ ¹æ®ä¸Šé™å€¼å’Œä¸‹é™å€¼è·å–æ»¡è¶³æ¡ä»¶çš„æ•°æ®æºé›†åˆ
        return Arrays.asList("ds1","ds2");
    }
}
```


#### å®šä¹‰è¡¨çš„åˆ†ç‰‡ç®—æ³•ç±» ğŸ—ï¸

```java
public class CommonAlgorithm4Tb implements PreciseShardingAlgorithm<Long>, RangeShardingAlgorithm<Long> {
    @Override
    public String doSharding(Collection<String> tbNames, PreciseShardingValue<Long> shardingValue) {
        //è·å–æ•°æ®åº“åˆ†ç‰‡çš„å­—æ®µåç§° user_id = in
        String columnName = shardingValue.getColumnName();
        //è·å–é€»è¾‘è¡¨åç§°
        String logicTableName = shardingValue.getLogicTableName();
        //è·å–ç‰‡é”®å¯¹åº”çš„å€¼ select * from t_order where order_id=10,è¿™é‡Œçš„valueå°±ç­‰äº10
        Long value = shardingValue.getValue();
        //ä¸€èˆ¬æ˜¯æ ¹æ®ç‰‡é”®å€¼è·å–å¯¹åº”çš„æ•°æ®æºï¼Œå¹¶è¿”å›
        String sufix=String.valueOf(value % 2 +1);
        String dsName = tbNames.stream().filter(ds -> ds.endsWith(sufix)).findFirst().get();
        return dsName;
    }
    
    @Override
    public Collection<String> doSharding(Collection<String> tbNames, RangeShardingValue<Long> shardingValue) {
        //è·å–åˆ†ç‰‡å­—æ®µ
        String columnName = shardingValue.getColumnName();
        //è·å–é€»è¾‘è¡¨
        String logicTableName = shardingValue.getLogicTableName();
        //è·å–èŒƒå›´æ•°æ®
        Range<Long> valueRange = shardingValue.getValueRange();
        //select * from t_order where user_id between 1 and 20;
        //åˆ¤æ–­æ˜¯å¦æœ‰ä¸Šé™å€¼
        if (valueRange.hasUpperBound()) {
            //è·å–ä¸Šé™å€¼ 20
            Long uppper = valueRange.upperEndpoint();
            System.out.println(uppper);
        }
        if (valueRange.hasLowerBound()){
            Long lower = valueRange.lowerEndpoint();
            System.out.println(lower);
        }
        //ç†è®ºä¸Šè¦æ ¹æ®ä¸Šé™å€¼å’Œä¸‹é™å€¼è·å–æ»¡è¶³æ¡ä»¶çš„æ•°æ®æºé›†åˆ
        return Arrays.asList("t_order_1","t_order_2");
    }
}
```


#### å®Œæ•´é…ç½®æ–‡ä»¶ ğŸ“

```properties
# ç¬¬ä¸€æ­¥ï¼šé…ç½®æ•°æ®æº --ã€‹æ•°æ®æºåç§°ï¼Œå¤šæ•°æ®æºä»¥é€—å·åˆ†éš”
spring.shardingsphere.datasource.names=ds1,ds2
# é…ç½®æ•°æ®æºçš„å…·ä½“ä¿¡æ¯
# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds1.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds1.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds1.url=jdbc:mysql://192.168.200.130:3306/order_db_1?serverTimezone=GMT%2B8
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds1.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds1.password=root

# æ•°æ®åº“è¿æ¥æ± ç±»åç§°
spring.shardingsphere.datasource.ds2.type=com.alibaba.druid.pool.DruidDataSource
# æ•°æ®åº“é©±åŠ¨ç±»å
spring.shardingsphere.datasource.ds2.driver-class-name=com.mysql.cj.jdbc.Driver
# æ•°æ®åº“ url è¿æ¥
spring.shardingsphere.datasource.ds2.url=jdbc:mysql://192.168.200.130:3306/order_db_2?serverTimezone=GMT%2B8
# æ•°æ®åº“ç”¨æˆ·å
spring.shardingsphere.datasource.ds2.username=root
# æ•°æ®åº“å¯†ç 
spring.shardingsphere.datasource.ds2.password=root

# ç¬¬äºŒæ­¥ï¼šé…ç½®ç‰©ç†èŠ‚ç‚¹
# ç”±æ•°æ®æºå + è¡¨åç»„æˆï¼Œä»¥å°æ•°ç‚¹åˆ†éš”ã€‚å¤šä¸ªè¡¨ä»¥é€—å·åˆ†éš”ï¼Œæ”¯æŒ inline è¡¨è¾¾å¼ã€‚
# ç¼ºçœè¡¨ç¤ºä½¿ç”¨å·²çŸ¥æ•°æ®æºä¸é€»è¾‘è¡¨åç§°ç”Ÿæˆæ•°æ®èŠ‚ç‚¹ï¼Œç”¨äºå¹¿æ’­è¡¨ï¼ˆå³æ¯ä¸ªåº“ä¸­éƒ½éœ€è¦ä¸€ä¸ªåŒæ ·çš„è¡¨ç”¨äºå…³è”æŸ¥è¯¢ï¼Œ
# å¤šä¸ºå­—å…¸è¡¨ï¼‰æˆ–åªåˆ†åº“ä¸åˆ†è¡¨ä¸”æ‰€æœ‰åº“çš„è¡¨ç»“æ„å®Œå…¨ä¸€è‡´çš„æƒ…å†µ
# åŸºäºè¡¨è¾¾å¼å®šä¹‰æ•°æ®èŠ‚ç‚¹ï¼Œgroovyè¡¨ç¤ºä¸­åº“å’Œè¡¨è‡ªåŠ¨ç¬›å¡å°”ç§¯ï¼šds1.t_order_1ï¼Œds1.t_order_2,ds2.t_order_1ï¼Œds2.t_order_2
spring.shardingsphere.sharding.tables.t_order.actual-data-nodes=ds${1..2}.t_order_${1..2}

# ç¬¬ä¸‰æ­¥ï¼šé…ç½®æ•°æ®åº“çš„åˆ†ç‰‡ç­–ç•¥
# æ­¤æ—¶è®¿é—®çš„åº“å­˜åœ¨å¤šä¸ªï¼Œéœ€è¦é€šè¿‡åº“çš„ç‰‡é”®æŒ‡å®šåˆ†åº“çš„ç®—æ³•
# åˆ†ç‰‡åˆ—åç§°
common.algorithm.db=com.itheima.sharding.algorithm.common.CommonAlgorithm4Db
common.algorithm.tb=com.itheima.sharding.algorithm.common.CommonAlgorithm4Tb
spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.sharding-column=user_id
# ç²¾ç¡®åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº = å’Œ INã€‚è¯¥ç±»éœ€å®ç° PreciseShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
#spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.precise-algorithm-class-name=com.itheima.sharding.algorithm.common.CommonAlgorithm4Db
spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.precise-algorithm-class-name=${common.algorithm.db}
# èŒƒå›´åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº BETWEENï¼Œå¯é€‰ã€‚è¯¥ç±»éœ€å®ç° RangeShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
#spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.range-algorithm-class-name=com.itheima.sharding.algorithm.common.CommonAlgorithm4Db
spring.shardingsphere.sharding.tables.t_order.database-strategy.standard.range-algorithm-class-name=${common.algorithm.db}

# ç¬¬å››éƒ¨ï¼šé…ç½®è¡¨çš„åˆ†ç‰‡ç­–ç•¥
# è¡Œè¡¨è¾¾å¼åˆ†ç‰‡ç­–ç•¥ å¦‚æœæŸ¥è¯¢æ—¶æ²¡æœ‰æŒ‡å®šè¡¨çš„ç‰‡é”®ä½œä¸ºæ¡ä»¶ï¼Œåˆ™å…¨é‡æŸ¥è¯¢å¯¹åº”æ•°æ®åº“ä¸‹çš„æ‰€æœ‰è¡¨
# åˆ†ç‰‡åˆ—åç§°
#spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.sharding-column=order_id
## åˆ†ç‰‡ç®—æ³•è¡Œè¡¨è¾¾å¼ï¼Œéœ€ç¬¦åˆ groovy è¯­æ³•
#spring.shardingsphere.sharding.tables.t_order.table-strategy.inline.algorithm-expression=t_order_${order_id % 2 +1}
# åˆ†ç‰‡åˆ—åç§°
spring.shardingsphere.sharding.tables.t_order.table-strategy.standard.sharding-column=order_id
# ç²¾ç¡®åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº = å’Œ INã€‚è¯¥ç±»éœ€å®ç° PreciseShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
#spring.shardingsphere.sharding.tables.t_order.table-strategy.standard.precise-algorithm-class-name=com.itheima.sharding.algorithm.common.CommonAlgorithm4Tb
spring.shardingsphere.sharding.tables.t_order.table-strategy.standard.precise-algorithm-class-name=${common.algorithm.tb}
# èŒƒå›´åˆ†ç‰‡ç®—æ³•ç±»åç§°ï¼Œç”¨äº BETWEENï¼Œå¯é€‰ã€‚è¯¥ç±»éœ€å®ç° RangeShardingAlgorithm æ¥å£å¹¶æä¾›æ— å‚æ•°çš„æ„é€ å™¨
#spring.shardingsphere.sharding.tables.t_order.table-strategy.standard.range-algorithm-class-name=com.itheima.sharding.algorithm.common.CommonAlgorithm4Tb
spring.shardingsphere.sharding.tables.t_order.table-strategy.standard.range-algorithm-class-name=${common.algorithm.tb}

# é…ç½®å¹¿æ’­è¡¨
# å¹¿æ’­è¡¨è§„åˆ™åˆ—è¡¨ å¸¸é‡çš„æ•°æ®ä¸”æ•°æ®é‡è¾ƒå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œä»¥é€—å·é—´éš”å³å¯
spring.shardingsphere.sharding.broadcast-tables=t_dict

# æ‰“å°é€»è¾‘sqlå’Œç‰©ç†sql
# æ˜¯å¦å¼€å¯ SQL æ˜¾ç¤ºï¼Œé»˜è®¤å€¼: false
spring.shardingsphere.props.sql.show=true
```